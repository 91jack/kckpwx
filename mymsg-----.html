<!doctype html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <title>本方信息</title>
  <link rel="stylesheet" type="text/css" href="static/css/common.css"/>
 	<link rel="stylesheet" href="static/css/app.css" />
 	<link rel="stylesheet" type="text/css" href="static/css/app1.css"/>
</head>
<body class="mymsg-page bg-f4">
	<!--顶部标题栏-->
	<div class="header-top">
		<div class="fl">
			<a href="javascript:;" class="goback">
				<em class="icon-goback"></em>
				<span class="goback-text">返回</span>
			</a>
		</div>
		<h2 class="header-top-title">本方信息</h2>
	</div>
	
	
	<!--内容区-->
	<div class="mymsg-content">
		<form class="form">
			<div class="form-group">
				<em>本方信息</em>
			</div>
			
			<div class="form-group">
				<span>姓名</span>
				<input type="text" placeholder="请输入姓名" class="fl" id="name"/>
				<a href="javascript:;" class="yzm-btn"></a>
			</div>
			
			<div class="form-group">
				<span>身份证号码</span>
				<input type="text" placeholder="请输入身份证号码" id="sfzcode"/>
			</div>
			
			<div class="form-group">
				<span>手机号码</span>
				<input type="text" placeholder="请输入手机号码" id="phone"/>
			</div>
			
			<div class="form-group">
				<span>号牌号码</span>
				<input type="text" placeholder="车牌号" class="fl" id="cpcode"/>
				<a href="javascript:;" class="yzm-btn"></a>
			</div>
			<div class="form-group">
				<span>好牌种类</span>
				<span class="fr">小型汽车</span>
				<em class="fr"></em>
			</div>
			
			<div class="form-group">
				<span>保险公司</span>
				<span class="fr">请选择(非必选)</span>
				<em class="fr"></em>
			</div>
			
		</form>
	</div>
	
	<div class="mymsg-btn">
		<div class="box">
			<a href="javascript:;">
				删除
			</a>
		</div>
		<div class="box">
			<a href="javascript:;">
				完成
			</a>
		</div>
	</div>
	<!--确认信息模态框-->
	<div class="msg-modal total">
		<div class="modal-content">
			<p>本方信息确认</p>
			<ul>
			</ul>
			<div class="modal-btn clearfix">
				<a href="javascript:;">
					取消
				</a>
				<a href="javascript:;">
					确定
				</a>
			</div>
		</div>
	</div>
	
	<!--绑定驾驶证模态框-->
	<div class="msg-modal drive">
		<div class="modal-content">
			<p>拍摄本方的驾驶证</p>
			<span>拍摄自己的驾驶证,自动识别信息!</span>
			<div class="msg-img">
				<img src="static/images/common/card_driver.png"/>
			</div>
			<div class="modal-btn clearfix">
				<a href="javascript:;">
					取消
				</a>
				<a href="javascript:;">
					确定
					<input type="file"/>
				</a>
			</div>
		</div>
	</div>
	
	<!--绑定行驶证-->
	<div class="msg-modal drive">
		<div class="modal-content">
			<p>拍摄本方的驾驶证</p>
			<span>拍摄自己的驾驶证,自动识别信息!</span>
			<div class="msg-img">
				<img src="static/images/common/card_xingshizheng.png"/>
			</div>
			<div class="modal-btn clearfix">
				<a href="javascript:;">
					取消
				</a>
				<a href="javascript:;">
					确定
					<input type="file"/>
				</a>
			</div>
		</div>
	</div>
	

<script src="static/js/jquery-3.1.1.min.js"  type="text/javascript" charset="utf-8"></script>
<script src="static/js/config.js" type="text/javascript" charset="utf-8"></script>
<script src="static/js/common.js"  type="text/javascript" charset="utf-8"></script>
<!--当前页面交互-->
<script type="text/javascript">
	//上传自己信息
	$('.mymsg-btn .box a').eq(1).click(function(){
		var name = $('#name').val();
		var cardNo = $('#sfzcode').val();
		var phone = $('#phone').val();
		var carNo = $('#cpcode').val();
		var carType = $('.form-group').eq(5).children('span').eq(1).html();
		var carTypeId = $('.form-group').eq(5).children('span').eq(1).attr('data');
		var insurance =$('.form-group').eq(6).children('span').eq(1).html();
		var insuranceId =$('.form-group').eq(6).children('span').eq(1).attr('data');
		var firstpic = $('.msg-modal.drive').eq(0).children('.modal-content').children('.msg-img').children('img').attr('src');
		var secondpic = $('.msg-modal.drive').eq(1).children('.modal-content').children('.msg-img').children('img').attr('src'); 
		var str = '<li>姓名：'+name+'</li>'
							+'<li>身份证号码：'+cardNo+'</li>'
							+'<li>手机号码：'+phone+'</li>'
							+'<li>号牌号码：'+carNo+'</li>'
							+'<li>号牌种类：'+carType+'</li>'
							+'<li>保险公司：'+insurance+'</li>'
							+'<li>请认证核实你的信息</li>'
		$('.msg-modal.total').children('.modal-content').children('ul').html('');
		$('.msg-modal.total').children('.modal-content').children('ul').append(str);
		$('.msg-modal.total').click(function(){
			$(this).css('display','none')
		});
		$.ajax({
			type:"post",
			url:addAccidentUserUrl,
			data:{
				token:localStorage.getItem('token'),
				accidentId:localStorage.getItem('accidentId'),
				name:name,
				cardNo:cardNo,
				phone:phone,
				carNo:carNo,
				carType:carTypeId,
				insuranceId:insuranceId,
				firstpic:'',
				secondpic:''
			},
			success:function(data){
				console.log(data);
				if (data.status==2000) {
					$('.msg-modal.total').css('display','block');
				}
			}
		});
		$('.msg-modal.total .modal-btn').children('a').eq(1).click(function(){
			$.ajax({
				type:"post",
				url:addAccidentUserFinishUrl,
				data:{
					token:localStorage.getItem('token'),
					accidentId:localStorage.getItem('accidentId')
				},
				success:function(data){
					console.log(data);
					if (data.status==2000) {
						window.location.href='inputmsg.html'
					}
				}
			})
		})
	})
	
	//上传证件(驾驶证)照片
	$('.form-group .yzm-btn').eq(0).click(function(){
		$('.msg-modal.drive').eq(0).css('display','block');
		$('.msg-modal.drive').eq(0).click(function(){
			$(this).css('display','none');
		})
		$('.msg-modal.drive').eq(0).children('.modal-content').children('.modal-btn').children('a').eq(1).click(function(){
			console.log(1111)
			$(this).change(function(){
				var that = $(this);
				uploadImg(that);
			});
		})
	})
	
	//上传证件(行驶证)照片
	$('.form-group .yzm-btn').eq(1).click(function(){
		$('.msg-modal.drive').eq(1).css('display','block');
		$('.msg-modal.drive').eq(1).click(function(){
			$(this).css('display','none');
		})
		$('.msg-modal.drive').eq(1).children('.modal-content').children('.modal-btn').children('a').eq(1).click(function(){
			console.log(2222);
			$(this).change(function(){
				var that = $(this);
				uploadImg(that);
			});
		})
	})
	
	function uploadImg(that){
		var accidentId = localStorage.getItem('accidentId');
		var formData = new FormData();	
		console.log(that.files[0])
//		formData.append('files',that.files[0]);
//		formData.append('accidentId',accidentId)
	
//		$.ajax({
//			type:"post",
//			url:uploadImgUrl,
//			data: formData,
//			processData: false,
//	        contentType: false,
//	        dataType: "json",
//			success: function(data){
//				console.log(data);
//				if(data.status == 2000){
//					console.log(data.list[0])
//					that.parent('a').parent('.modal-btn').siblings('div.msg-img').children('img').attr("src",data.list[0]).css({
//						'width':'100%',
//						'height':'10.791666rem',
//						'margin-top':'0'
//					});
//				}
//			}
//		});
	}
</script>

</body>
</html>
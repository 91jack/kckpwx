<!doctype html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <title>事故地点定位</title>
  <link rel="stylesheet" type="text/css" href="static/css/common.css"/>
 	<link rel="stylesheet" href="static/css/app.css" />
	<link rel="stylesheet" type="text/css" href="static/css/app1.css"/>
</head>
<body class="mymsg-page">
	<!--顶部标题栏-->
	<div class="header-top">
		<div class="fl">
			<a href="javascript:;" class="goback">
				<em class="icon-goback"></em>
				<span class="goback-text">返回</span>
			</a>
		</div>
		<h2 class="header-top-title">事故地点定位</h2>
	</div>
	
	<!--顶部警察提示-->
	<div class="mymsg-content">
		<div id="map">
			
		</div>
	</div>
	
	
 	<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=wqB7npvF7DsDGlFG2oYhih93K5iEqsou"></script>
<script src="static/js/jquery-3.1.1.min.js"  type="text/javascript" charset="utf-8"></script>
<script src="static/js/config.js" type="text/javascript" charset="utf-8"></script>
<script src="static/js/common.js"  type="text/javascript" charset="utf-8"></script>
<!--当前页面交互-->
<script type="text/javascript">
// 地图初始化
		   	var map = new BMap.Map("map");    // 创建Map实例
		   	var point =  new BMap.Point(106.552278,29.571751);
			map.centerAndZoom(point, 18);  // 初始化地图,设置中心点坐标和地图级别	  
			map.addControl(new BMap.GeolocationControl()); // 定位
			
			// 当前定位
			var geolocation = new BMap.Geolocation();
			geolocation.getCurrentPosition(function(r){
				if(this.getStatus() == BMAP_STATUS_SUCCESS){
					position(r)
//					var mk = new BMap.Marker(r.point);
//					map.addOverlay(mk);
//					map.panTo(r.point);
//					
//					// 逆地址解析
//					var geoc = new BMap.Geocoder();
//					geoc.getLocation(r.point, function(rs){
//						var addComp = rs.addressComponents;
//						var address = addComp.province + ", " + addComp.city + ", " + addComp.district + ", " + addComp.street + ", " + addComp.streetNumber
//						addr.innerHTML = address;
//					})
				}
				else {
					alert('failed'+this.getStatus());
				}        
			});
			
			function showInfo(e){
				position(e)
//				var mk = new BMap.Marker(e.point);
//				map.addOverlay(mk);
//				map.panTo(e.point);
//				
//				// 逆地址解析
//				var geoc = new BMap.Geocoder();
//				geoc.getLocation(e.point, function(rs){
//					var addComp = rs.addressComponents;
//					var address = addComp.province + ", " + addComp.city + ", " + addComp.district + ", " + addComp.street + ", " + addComp.streetNumber
//					addr.innerHTML = address;
//				})
			}
			map.addEventListener("click", showInfo);
			function position(e){
				var mk = new BMap.Marker(e.point);
				map.addOverlay(mk);
				map.panTo(e.point);
				
				// 逆地址解析
				var geoc = new BMap.Geocoder();
				geoc.getLocation(e.point, function(rs){
					var addComp = rs.addressComponents;
					var address = addComp.province + ", " + addComp.city + ", " + addComp.district + ", " + addComp.street + ", " + addComp.streetNumber
					//addr.innerHTML = address;
					console.log(address)
				})
			}
			
			console.log(1111)
//	获取地址
//			$('#submap').click(function() {
//				add= $('#addr').html();
//				localStorage.setItem('add',add);
//				window.location.href='step5.html'
//			})
		</script>

</body>
</html>